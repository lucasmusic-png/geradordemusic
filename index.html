<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Crie suas pr√≥prias m√∫sicas gratuitamente. 100% dos direitos autorais s√£o seus!">
    <title>Gerador de M√∫sicas Gratuito</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/tone@14.7.77/build/Tone.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { margin: 0; padding: 0; font-family: system-ui, -apple-system, sans-serif; }
        @keyframes pulse-slow { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .animate-pulse-slow { animation: pulse-slow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const MusicGenerator = () => {
            const [currentTab, setCurrentTab] = useState('lyrics');
            const [songData, setSongData] = useState({
                title: '', lyrics: '', genre: 'pop', tempo: 120, key: 'C', structure: 'verse-chorus-verse-chorus'
            });
            const [instruments, setInstruments] = useState({
                piano: true, synth: true, bass: true, drums: true, strings: false, guitar: false
            });
            const [generatedSong, setGeneratedSong] = useState(null);
            const [isGenerating, setIsGenerating] = useState(false);
            const [isPlaying, setIsPlaying] = useState(false);
            const [songsGenerated, setSongsGenerated] = useState(0);
            const synthsRef = useRef({});

            useEffect(() => {
                synthsRef.current = {
                    piano: new Tone.PolySynth(Tone.Synth).toDestination(),
                    synth: new Tone.PolySynth(Tone.Synth).toDestination(),
                    bass: new Tone.MonoSynth().toDestination(),
                    drums: {
                        kick: new Tone.MembraneSynth().toDestination(),
                        snare: new Tone.NoiseSynth().toDestination(),
                        hihat: new Tone.MetalSynth().toDestination()
                    }
                };
                const saved = localStorage.getItem('songsGenerated');
                if (saved) setSongsGenerated(parseInt(saved));
                return () => Object.values(synthsRef.current).forEach(s => s.dispose && s.dispose());
            }, []);

            const scales = {
                'C': ['C','D','E','F','G','A','B'], 'D': ['D','E','F#','G','A','B','C#'],
                'E': ['E','F#','G#','A','B','C#','D#'], 'G': ['G','A','B','C','D','E','F#']
            };
            const chordProgressions = {
                pop: [[0,5,3,4]], rock: [[0,4,5,4]], ballad: [[0,3,5,4]]
            };

            const generateSong = () => {
                setIsGenerating(true);
                setTimeout(() => {
                    const scale = scales[songData.key] || scales['C'];
                    const prog = chordProgressions[songData.genre] || chordProgressions['pop'];
                    const chords = prog[0].map(d => [scale[d%7]+'3', scale[(d+2)%7]+'3', scale[(d+4)%7]+'3']);
                    const melody = Array(16).fill(0).map(() => scale[Math.floor(Math.random()*7)]+'4');
                    setGeneratedSong({ chords, melody });
                    setIsGenerating(false);
                    setCurrentTab('preview');
                    const n = songsGenerated + 1;
                    setSongsGenerated(n);
                    localStorage.setItem('songsGenerated', n);
                }, 1500);
            };

            const playSong = async () => {
                await Tone.start();
                setIsPlaying(true);
                const now = Tone.now();
                const bd = 60/songData.tempo;
                generatedSong.chords.forEach((c,i) => {
                    if(instruments.piano) synthsRef.current.piano.triggerAttackRelease(c, '2n', now+i*bd*4);
                });
                generatedSong.melody.forEach((n,i) => {
                    if(instruments.piano) synthsRef.current.piano.triggerAttackRelease(n, '8n', now+i*bd);
                });
                if(instruments.drums) {
                    for(let i=0; i<16; i++) {
                        const t = now+i*bd;
                        if(i%4===0) synthsRef.current.drums.kick.triggerAttackRelease('C1','8n',t);
                        if(i%4===1||i%4===3) synthsRef.current.drums.snare.triggerAttackRelease('8n',t);
                    }
                }
                setTimeout(() => setIsPlaying(false), 16*bd*1000);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 p-4 md:p-8">
                    <div className="max-w-6xl mx-auto">
                        <div className="bg-white/10 backdrop-blur-lg rounded-2xl shadow-2xl overflow-hidden mb-6">
                            <div className="bg-gradient-to-r from-purple-600 to-pink-600 p-6">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <h1 className="text-3xl font-bold text-white">üéµ Gerador de M√∫sicas</h1>
                                        <p className="text-purple-100 text-sm">100% Gratuito - Seus Direitos</p>
                                    </div>
                                    <div className="bg-white/20 rounded-lg px-4 py-2 text-center">
                                        <p className="text-2xl font-bold text-white">{songsGenerated}</p>
                                        <p className="text-xs text-purple-100">M√∫sicas</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white/10 backdrop-blur-lg rounded-2xl shadow-2xl overflow-hidden">
                            <div className="flex border-b border-white/20">
                                {['lyrics','settings','preview'].map(t => (
                                    <button key={t} onClick={() => setCurrentTab(t)}
                                        className={`flex-1 py-4 px-6 font-semibold transition ${
                                            currentTab===t ? 'bg-white/20 text-white border-b-2 border-white' : 'text-purple-200 hover:bg-white/10'
                                        }`}>
                                        {t==='lyrics'&&'üìù Letra'}{t==='settings'&&'‚öôÔ∏è Config'}{t==='preview'&&'üéµ Preview'}
                                    </button>
                                ))}
                            </div>

                            <div className="p-6">
                                {currentTab==='lyrics' && (
                                    <div className="space-y-6">
                                        <div>
                                            <label className="block text-white font-semibold mb-2">T√≠tulo</label>
                                            <input type="text" value={songData.title} 
                                                onChange={e => setSongData({...songData, title: e.target.value})}
                                                placeholder="Nome da sua m√∫sica" 
                                                className="w-full p-3 rounded-lg bg-white/20 text-white placeholder-purple-300 border border-white/30" />
                                        </div>
                                        <div>
                                            <label className="block text-white font-semibold mb-2">Letra</label>
                                            <textarea value={songData.lyrics}
                                                onChange={e => setSongData({...songData, lyrics: e.target.value})}
                                                placeholder="Digite sua letra aqui..." rows={12}
                                                className="w-full p-4 rounded-lg bg-white/20 text-white placeholder-purple-300 border border-white/30" />
                                        </div>
                                    </div>
                                )}

                                {currentTab==='settings' && (
                                    <div className="space-y-6">
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            <div>
                                                <label className="block text-white font-semibold mb-2">G√™nero</label>
                                                <select value={songData.genre} onChange={e => setSongData({...songData, genre: e.target.value})}
                                                    className="w-full p-3 rounded-lg bg-white/20 text-white border border-white/30">
                                                    <option value="pop">Pop</option>
                                                    <option value="rock">Rock</option>
                                                    <option value="ballad">Balada</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label className="block text-white font-semibold mb-2">Tom</label>
                                                <select value={songData.key} onChange={e => setSongData({...songData, key: e.target.value})}
                                                    className="w-full p-3 rounded-lg bg-white/20 text-white border border-white/30">
                                                    <option value="C">D√≥ (C)</option>
                                                    <option value="D">R√© (D)</option>
                                                    <option value="E">Mi (E)</option>
                                                    <option value="G">Sol (G)</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div>
                                            <label className="block text-white font-semibold mb-2">BPM: {songData.tempo}</label>
                                            <input type="range" min="60" max="180" value={songData.tempo}
                                                onChange={e => setSongData({...songData, tempo: parseInt(e.target.value)})}
                                                className="w-full" />
                                        </div>
                                        <div>
                                            <label className="block text-white font-semibold mb-3">Instrumentos</label>
                                            <div className="grid grid-cols-2 md:grid-cols-3 gap-3">
                                                {Object.entries(instruments).map(([k,v]) => (
                                                    <label key={k} className="flex items-center gap-2 bg-white/10 rounded-lg p-3 cursor-pointer">
                                                        <input type="checkbox" checked={v} onChange={e => setInstruments({...instruments, [k]: e.target.checked})} />
                                                        <span className="text-white capitalize">{k==='synth'?'Sintetizador':k==='drums'?'Bateria':k}</span>
                                                    </label>
                                                ))}
                                            </div>
                                        </div>
                                        <button onClick={generateSong} disabled={isGenerating}
                                            className="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold py-4 rounded-xl">
                                            {isGenerating ? '‚è≥ Gerando...' : '‚ú® Gerar M√∫sica'}
                                        </button>
                                    </div>
                                )}

                                {currentTab==='preview' && (
                                    <div className="space-y-6">
                                        {!generatedSong ? (
                                            <div className="text-center py-12">
                                                <p className="text-white text-lg">Configure e gere sua m√∫sica primeiro!</p>
                                            </div>
                                        ) : (
                                            <>
                                                <div className="bg-white/10 rounded-xl p-6">
                                                    <h3 className="text-white font-bold text-xl">{songData.title || 'Sem T√≠tulo'}</h3>
                                                </div>
                                                <button onClick={isPlaying ? () => setIsPlaying(false) : playSong}
                                                    className={`w-full font-bold py-4 rounded-xl ${isPlaying ? 'bg-red-500' : 'bg-green-500'} text-white`}>
                                                    {isPlaying ? '‚èπÔ∏è Parar' : '‚ñ∂Ô∏è Tocar'}
                                                </button>
                                                <div className="bg-green-500/20 border border-green-500/50 rounded-lg p-4">
                                                    <p className="text-green-200 text-sm">‚úÖ Esta m√∫sica √© 100% sua! Todos os direitos autorais pertencem a voc√™!</p>
                                                </div>
                                            </>
                                        )}
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        ReactDOM.createRoot(document.getElementById('root')).render(<MusicGenerator />);
    </script>
</body>
</html>